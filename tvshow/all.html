
<!DOCTYPE html><html class=''>
<head>

   <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
            <link async href="css/feed.css" rel="stylesheet">
                  <link async href="css/font-awesome.min.css" rel="stylesheet">


</head>
<body>
<div class="contain">
<h1>EPISODES</h1>
<p>Made By <a href="https://twitter.com/itsMangoPlays">@itsMangoPlays </a></p>
  <h1 style="text-align:center;font-size:xx-large">FOX,CW,ABC  Episodes</h1>

  <input type="text" name="" id="search" oninput="search(this.value)">
   <ul id="carasoul" class="fanarts-list list-unstyled list-inline">
</ul>
   </div>

   <script type="text/javascript" src="js/fetch.min.js"></script> 

<script>
function addJS(url) {
   var s = document.createElement('script'); // Create a script element
   s.type = "text/javascript"; // optional in html5
   s.async = true; // asynchronous? true/false
   s.src = url;
   var fs = document.getElementsByTagName('script')[0]; // Get the first script
   fs.parentNode.insertBefore(s, fs);
};



function search(val){
function filter(a)
{
    var match = []

    for (var i = 0; i < a.length; i++)
    {
        if ( a[i].metadata.toLowerCase().includes(val.toLowerCase()) ) match.push(a[i])
    }

    return match
}

var result = filter(obj);

if (result.length == 0) {
document.getElementById('carasoul').innerHTML = "No results found :("
console.log(result.length)
	}else{
	loadMedia(result)
}
console.log(result.length)
	

}
var theflash = 'http://images.cwtv.com/feed/mobileapp/videos/apiversion_7/show_the-flash'
var show_hub = 'http://images.cwtv.com/feed/mobileapp/videos/apiversion_7/show_hub'
var shows = 'http://images.cwtv.com/feed/mobileapp/shows/apiversion_7/channel_cwtv/pagesize_100'
var proxy = 'https://cors-anywhere.herokuapp.com/'
var template = "";
if (!window.fetch) {
	alert('fetch isnt working')
}
function formatDate(date) {
    var d = new Date(date),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

    if (month.length < 2) month = '0' + month;
    if (day.length < 2) day = '0' + day;

    return [year, month, day].join('-');
}
// url (required), options (optional)
function fmtMSS(s){return(s-(s%=60))/60+(9<s?':':':0')+s}
function rating(rate){
if (rate.includes('tv-14')) {
	return "TV-14"
}
	if (rate.includes('tv-pg')) {
		return "TV-PG"
	}

	if (rate.includes('tv-y7')) {
		return "TV-Y7"
	}


	if(rate.includes('tv-y')){
		return "TV-Y"
	}

	if(rate.includes('tv-g')){
		return "TV-G"
	}

}

function loadMedia(json){
json = json.sort(function(a, b) {
    a = new Date(a.airdate);
    b = new Date(b.airdate);
    return a>b ? -1 : a<b ? 1 : 0;
})
	template = ''
 for(i in json){
  
  template = template + '<li class=initialized ><div class="piece fanart-container"><div class=image-crop><a href="'+json[i].href+'"><img alt="'+json[i].show+'" data-src="'+json[i].img+'" class"lazy" ></a><div class="overlay"><a href="player.html?'+json[i].href+'" class="overlay-btn zoom-btn " title="Watch"><i class="fa fa-play"></i></a></div></div><div class="episode-details fanart-details"><h2><a href="player.html?'+json[i].href+'">'+json[i].episode+'</a></h2><a href="player.html?'+json[i].href+'" class=secondary-link>'+json[i].show +'</a><div class=more-infos></div><p>'+json[i].airdate+' | ' + json[i].rating + ' | '+json[i].length +' | '+json[i].epiformat+'</div></div>'
      document.getElementById('carasoul').innerHTML = template;
 

 }

      template = '';


      [].forEach.call(document.querySelectorAll('img[data-src]'), function(img) {
	img.setAttribute('src', img.getAttribute('data-src'));
	img.onload = function() {
		img.removeAttribute('data-src');
	};
});

}
function epiformat(s,e){

	if (s < 10) {
s = 0 + s
	}
		if (e < 10) {
e = 0 + e
	}

	return 'S' + s + 'E' + e
}
function toTitleCase(str)
{
    return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
} 

 function msToTime(duration) {
        var milliseconds = parseInt((duration%1000)/100)
            , seconds = parseInt((duration/1000)%60)
            , minutes = parseInt((duration/(1000*60))%60)
            , hours = parseInt((duration/(1000*60*60))%24);

        hours = (hours < 10) ? "0" + hours : hours;
        minutes = (minutes < 10) ? "0" + minutes : minutes;
        seconds = (seconds < 10) ? "0" + seconds : seconds;

        return  minutes + ":" + seconds ;
    }
var template = "";



	          var obj = []





fetch(proxy + show_hub, {
    method: 'get'
}).then(function(response) {
    return response.json();
}).then(function(data){
var start = new Date()

 for(i in data.videos){
   if(data.videos[i].fullep == 1){
     function millisToMinutesAndSeconds(millis) {
  var minutes = Math.floor(millis / 60000 * 60);
  var seconds = ((millis % 60000) / 1000).toFixed(0);
  return minutes;
}

var epinum = data.videos[i].episode
try{
epinum = data.videos[i].availability_asset_id.split('-')[data.videos[i].availability_asset_id.split('-').length - 1]

}catch(e){
console.log(e)
}



  obj.push({img:data.videos[i].large_thumbnail,
  	rating:(data.videos[i].rating),
  	href: data.videos[i].share_url,
  	airdate:data.videos[i].airdate,
  	show:data.videos[i].series_name,
  	episode:data.videos[i].title,
  	epiformat:epinum,
  	length:data.videos[i].duration,
  	metadata:data.videos[i].rating + data.videos[i].airdate + data.videos[i].series_name + data.videos[i].title + epinum + data.videos[i].duration
  })




     

   }
   }
      loadMedia(obj)

   template = ''
   var end = new Date()

   console.log(end.getTime() - start.getTime())


}).catch(function(err) {
console.log(err.message)
});











function fox(range){
fetch('https://feed.theplatform.com/f/fox.com/metadata?count=true&byCustomValue={fullEpisode}{true}&range=' + range, {
	method: 'get'
}).then(function(response) {
	return response.json();
}).then(function(data){
for(i in data.results){
 	if (Date.now() > data.results[i].authEndDate) {

  obj.push({img:data.results[i].videoStillURL,
  	rating:rating(data.results[i].rating),
  	href: data.results[i].videoURL,
  	airdate:data.results[i].airdate,
  	show:data.results[i].series.split('/')[data.results[i].series.split('/').length - 1],
  	episode:data.results[i].name,
  	epiformat:epiformat(data.results[i].season,data.results[i].episode),
  	length:fmtMSS(data.results[i].length),
  	metadata:rating(data.results[i].rating) + data.results[i].airdate + data.results[i].series.split('/')[data.results[i].series.split('/').length - 1] + data.results[i].name + epiformat(data.results[i].season,data.results[i].episode) + fmtMSS(data.results[i].length)
  })



}
   }
         loadMedia(obj)

   console.log(obj)

}).catch(function(err) {
console.log(err)
});
}

function procABC(showepi){

for(a in showepi.videos.video){
 var thumb 

	try{

			if (showepi.videos.video[a].hasOwnProperty('thumbnails')) {
			
thumb = showepi.videos.video[a].thumbnails.thumbnail[0].$		}


	 	 	var airdate = formatDate(showepi.videos.video[a].airdates.airdate)



	}catch(e){
console.log(e)
	}
  obj.push({img:thumb,
  	rating:(showepi.videos.video[a].tvrating.rating),
  	href: "abc.go.com/vidcode=" + showepi.videos.video[a]['@id'],
  	airdate:airdate,
  	show:showepi.videos.video[a].show.title,
  	episode:showepi.videos.video[a].title,
  	epiformat:epiformat(showepi.videos.video[a].season.trackcode.generic.cseason,showepi.videos.video[a].number),
  	length:msToTime(showepi.videos.video[a].duration['$']),
  	 metadata:(showepi.videos.video[a].tvrating.rating) + airdate + showepi.videos.video[a].show.title + showepi.videos.video[a].show.title + epiformat(showepi.videos.video[a].season.trackcode.generic.cseason,showepi.videos.video[a].number) + msToTime(showepi.videos.video[a].duration['$'])
});
           loadMedia(obj)

}
}



function useABC(json){
console.log(json)

for(i in json.shows.show){
addJS('https://api.watchabc.go.com/vp2/ws/s/contents/2020/videos/jsonp/001/001/-1/'+json.shows.show[i]['@id']+'/-1/-1/-1/-1?callback=procABC')

}





         loadMedia(obj)

}


// addJS('https://api.watchabc.go.com/vp2/ws/s/contents/2020/shows/jsonp/001/001/-1?callback=useABC')








fetch('http://feed.theplatform.com/f/OyMl-B/8IyhuVgUXDd_?count=true&form=json&range=0-40', {
	method: 'get'
}).then(function(response) {
	return response.json();
}).then(function(data){
	console.log(data.entries)
for(i in data.entries){

  obj.push({img:data.entries[i].videoStillURL,
  	rating:rating(data.entries[i].rating),
  	href: data.entries[i].videoURL,
  	airdate:data.entries[i].airdate,
  	show:data.entries[i].series.split('/')[data.entries[i].series.split('/').length - 1],
  	episode:data.entries[i].name,
  	epiformat:epiformat(data.entries[i].season,data.entries[i].episode),
  	length:fmtMSS(data.results[i].length),
  	metadata:rating(data.entries[i].rating) + data.entries[i].airdate + data.entries[i].series.split('/')[data.entries[i].series.split('/').length - 1] + data.entries[i].name + epiformat(data.entries[i].season,data.entries[i].episode) + fmtMSS(data.entries[i].length)
  })




   }
         loadMedia(obj)

   console.log(obj)

}).catch(function(err) {
console.log(err)
});











   fox('0-25')


</script>
</body></html>