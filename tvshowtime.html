<!DOCTYPE html>
<html>
<head>

 <meta name="apple-mobile-web-app-status-bar-style" content="black" />

   <meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-title" content="TVShow Time++" />
    <link rel="apple-touch-startup-image" href="/apploader.png">




<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi" crossorigin="anonymous">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

<style type="text/css">
	.header {
    background: #f7d633;
    padding: 2%;
    text-align: center;
    font-size: medium;
    font-family: 'Montserrat', sans-serif;
    font-weight: 700;
    width: 100%;
    padding-bottom: 2%;


}

img{
	    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
	    border-radius: 0%;
	    width: 90%;

}

.h5, h5 {
    font-size: 1.05rem;
    color: #858585;
    font-weight: 400;
}

.table td, .table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #eceeef;
    font-size: larger;
}

h1{
	font-size: 1.5rem;
	    color: #393939;
}
p {
    margin-top: 0;
    margin-bottom: 1rem;
    font-weight: 700;
}

</style>

	<title>TVShow Time++</title>
</head>
<body>
<div class="header">
EPISODES TO WATCH
</div>
<div class="tableborder">
<table id="tablediv" class="table">

<i id="spinner" class="fa fa-refresh fa-spin" style="
    font-size: 100px;
    margin: auto;
    display: table;
    vertical-align: baseline;
    position: absolute;
    padding: 39%;
"></i>

</table>
</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" ></script>
    <script type="text/javascript">
	var googleurl


 
    function pad(n) {
    return (n < 10) ? ("0" + n) : n;
}
var spinner = document.getElementById('spinner')
	var finalurl
var clickablelink
    var div = document.getElementById('tablediv')
var googlejson
    var tempel = ""
    var i 
    var finishjson
$.getJSON( "https://api.tvshowtime.com/v1/to_watch?access_token=82fb423156c817655962b583129a696d&limit=100&lang=en", function(json) {

	finishjson = json
function makelink(url) {
	var nameshow
	var nameepi
var samedata =  encodeURIComponent(json.episodes[i].show.name + " "  +  json.episodes[i].name)


$.getJSON("https://api.tvshowtime.com/v1/episode?episode_id=" + json.episodes[i].id + "&access_token=82fb423156c817655962b583129a696d" , function(network) {


	console.log(network.episode.network)


var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      	googlejson = JSON.parse(this.responseText);
       
      	googleurl = googlejson.results[0].unescapedUrl


	
if(network.episode.network == "The CW"){
finalurl =  "cwfetch?url=" + googleurl

      	      	      	      	clickablelink = finalurl

return finalurl;

}
if(network.episode.network == "ABC (US)"){
finalurl = "abcfetch.html?url=" + googleurl

      	      	      	      	clickablelink = finalurl

return finalurl;

}
if(network.episode.network == "FOX (US)"){
finalurl = "foxfetch.html?url=" + googleurl

      	      	      	      	clickablelink = finalurl

return finalurl;

}
if(network.episode.network == "Netflix"){
finalurl = ("netflixfetch.html?url=" + googleurl)
      	                       	clickablelink = finalurl
return finalurl;

}}};



  xhttp.open("GET", "https://www.googleapis.com/customsearch/v1element?key=AIzaSyCVAXiUzRYsML1Pv6RwSG1gunmMikTzQqY&rsz=filtered_cse&num=1&hl=en&prettyPrint=false&source=gcsc&gss=.com&sig=0c3990ce7a056ed50667fe0c3873c9b6&cx=009916453314335219988:-0yvqrz4snu&q=" + url  , true);
  xhttp.send();





	});


                            
}
      for (var i = 0; i < json.episodes.length; i++){

 var mathleft = (  finishjson.episodes[i].show.aired_episodes*1 - finishjson.episodes[i].show.seen_episodes*1)


 if (mathleft == 1) {
mathleft = "Last!"

 }
 if (mathleft > 1){
 	mathleft = "+" + mathleft
 }



      	tempel = tempel + ' <tr><th scope="row"><img src="' + finishjson.episodes[i].show.images.poster["4"] + '"></th><td><h1>' + finishjson.episodes[i].show.name + '</h1><p>' + "S" + pad(finishjson.episodes[i].season_number) + "E" + pad(finishjson.episodes[i].number)  +'</p><h5>'+   mathleft  + '</h5><h5>'+ finishjson.episodes[i].name +'</h5><a href="'+ "validator.html?"  +  finishjson.episodes[i].show.name +" - " +finishjson.episodes[i].name +'" class="btn btn-outline-success">Play</a></td></tr>'
 

            
            }


            div.innerHTML = tempel
            spinner.style.display = "none";

});


    </script>
</body>
</html>